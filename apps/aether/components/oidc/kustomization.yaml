---
apiVersion: kustomize.config.k8s.io/v1alpha1
kind: Component
patches:
  - target:
      kind: Deployment
      name: aether
    patch: |
      - op: add
        path: /spec/template/spec/volumes/-
        value:
          name: aether-secret
          secret:
            secretName: aether
            items:
              - key: oidc_secret_id
                path: aether_oidc_secret_id
      - op: add
        path: /spec/template/spec/containers/0/volumeMounts/-
        value:
          name: aether-secret
          mountPath: /aether_oidc_secret_id
          subPath: aether_oidc_secret_id
          readOnly: true
